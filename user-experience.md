# ユーザー体験設計書

*最終更新: 2025-01-18*

## 初期登録

### アカウント登録
- 新規ユーザーがアプリを初回起動時にアカウントを作成
- メールアドレスとパスワードによる認証（6文字以上）
- 美しいグラデーション背景のログイン画面
- リアルタイムバリデーション（入力チェック）

### ログイン/ログアウト
- 既存ユーザーのメールアドレス・パスワードによるログイン
- Supabase Authによるセッション管理とログイン状態の維持
- ヘッダーからのワンタップログアウト機能
- 認証エラー時の分かりやすいエラーメッセージ

## 常備食材の登録

### 食材名を登録
- ユーザーが普段冷蔵庫に常備している食材をリストアップ
- 簡潔なフォーム（食材名入力 + 追加ボタン）
- リアルタイム重複チェック機能
- Enterキーでの素早い追加対応

### 管理機能
- **編集機能**: インライン編集（✏️ボタン）
- **削除機能**: 確認ダイアログ付き削除（🗑️ボタン）
- **検索・ソート**: アルファベット順自動ソート
- **使い方ヒント**: 調味料・冷凍食品も含む説明

## 常備食材の確認

### 冷蔵庫撮影
- 冷蔵庫の写真を3つの画角から撮影してアップロード：
  1. **🥛 冷蔵室正面**: メイン冷蔵庫内部の全体像
  2. **🧂 冷蔵室扉**: ドアポケット
  3. **🥬 野菜室**: 野菜室
- **柔軟な撮影**: 1つ以上のエリアで分析可能（全てのエリア必須ではない）
- **画像縦横比保持**: `object-fit: contain`による適切な表示
- **撮影状況表示**: アップロード・分析・完了の3段階ステータス

### AI分析と編集機能
- **GPT-4oによる自動解析**: 各画像を個別に分析
- **リアルタイム分析状況表示**:
  - 🤖 AI分析中...（スピナー表示）
  - ✅ 分析完了（検出件数表示）
  - ⚠️ 分析失敗（再撮影推奨）
- **検出結果の表示**:
  - AI検出結果の一覧表示
  - 検出された食材の編集機能（名前、残量の修正）
  - 手動での食材追加機能（➕ 手動追加ボタン）
  - AI生成と手動追加の視覚的区別（色分け表示）
  - 検出精度（信頼度%）の表示
- **量の選択**: 「多い」「普通」「少ない」の3段階（「なし」は削除済み）

### 買い物リスト自動生成
- **スマートな照合ロジック**:
  - AI分析結果と事前登録した常備食材リストを自動照合
  - **不足している食材**を自動検出
  - **量が「少ない」と判定された食材**も自動追加
- **ユーザー確認・編集**:
  - 買い物リストの事前確認画面
  - チェックボックスによる個別選択
  - 不要なアイテムの除外機能
- **分析統計表示**: 撮影エリア数・検出食材数の表示

## 買い物リストの確認

### 買い物中の利用
- **モバイル最適化UI**: スマートフォンでの使いやすさを重視
- **進捗統計パネル**: 残り・購入済み・完了率の表示
- **買い物リストのチェックオフ機能**:
  - タップで購入完了をマーク
  - 視覚的フィードバック（チェックマーク・取り消し線）
  - 購入済みアイテムの透明度変更
- **買い物完了後のリスト更新**: リアルタイムデータ同期

### リスト管理機能
- **手動追加**: 新しい食材の追加機能
- **アイテム削除**: 個別削除機能（確認ダイアログ付き）
- **購入済み一括削除**: 完了したアイテムの整理機能
- **表示フィルター**: 「購入済みも表示」トグルスイッチ
- **リフレッシュ機能**: 🔄ボタンによる手動更新

### ユーザビリティ向上
- **完了メッセージ**: 全買い物完了時の祝福メッセージ
- **進捗可視化**: パーセンテージによる達成度表示
- **タッチ最適化**: 大きなタップエリア・指に優しいサイズ
- **使い方ヘルプ**: 機能説明・コツの表示

## 技術的特徴

### レスポンシブデザイン
- **モバイルファースト**: スマートフォンでの使用を最優先
- **タブレット対応**: 画面サイズに応じた最適なレイアウト
- **タッチデバイス最適化**: ホバー効果なしデバイスへの配慮

### パフォーマンス
- **画像最適化**: アップロード時の適切な圧縮・形式変換
- **リアルタイム同期**: Supabaseによる即座のデータ更新
- **ローディング状態**: 適切なローディング表示とフィードバック

### セキュリティ・プライバシー
- **ユーザーデータ保護**: Row Level Securityによる完全な分離
- **セッション管理**: 安全な認証状態の管理
- **エラーハンドリング**: 分かりやすいエラーメッセージ表示

## 想定ユーザージャーニー

### 初回利用時
1. **アプリアクセス** → **新規登録** → **メール認証**
2. **常備食材登録** (5-10個の基本食材)
3. **冷蔵庫撮影** → **AI分析結果確認** → **買い物リスト生成**
4. **外出先で買い物リスト確認** → **購入完了をマーク**

### 継続利用時
1. **冷蔵庫撮影** → **結果確認・編集** → **買い物リスト更新**
2. **買い物中にリスト確認** → **チェックオフ**
3. **必要に応じて常備食材の追加・削除**

### 期待効果
- **買い忘れ防止**: 常備食材との自動照合
- **効率化**: 手動リスト作成の手間削減
- **可視化**: 冷蔵庫の状況把握
- **節約**: 重複購入の防止
